---
layout: post
title: "[AWS] ECS EC2 배포(2) - VPC 서브넷"
description: "AWS ECS EC2 배포 방법 - VPC 서브넷"
date: 2025-02-12 10:30:00 +0900
categories: [AWS]
tags: [AWS, ECS, EC2]
toc: true
---

## 서브넷 생성

VPC를 생성을 했으면 서브넷도 생성을 해야 한다. VPC만 생성해서는 아직 아무것도 할 수 없다.

VPC는 CIDR 블록을 가지는 단위로 나눠지는데, 서브넷은 실제로 리소스가 생성되는 물리적인 공간인
가용존과 연결이 된다.

VPC가 논리적인 범위를 의미한다면 서브넷은 VPC 내부에서 실제로 리소스가 생성될 수 있는
네트워크를 의미한다.

### 생성하기

![서브넷 생성 시 VPC 선택](/assets/img/post/screenshot-2025-02-12-10-38-25.png)

서브넷 생성 버튼을 누리고 생성 페이지에 진입을 하게 되면 생성해놓은 VPC를 선택을 해준다.

스크롤을 아래로 내리다보면 서브넷 설정을 할 수 있다.

![서브넷 설정](/assets/img/post/screenshot-2025-02-12-10-43-57.png)

여기서는 서브넷 이름과, <u>IPv4 CIDR 블록</u>을 설정을 해준다.

우리는 VPC IP 대역을 **10.0.0.0/24**로 생성을 해줬으니 서브넷 블록을 아래와 같이 설정을 해준다.

예를 들면
* **서브넷 이름: my-public-subnet-a**
* **IPv4 CIDR 블록: 10.0.0.0/28**

이렇게 설정을 해준다. 한꺼번에 생성을 해주고 싶으면 새 서브넷 추가 버튼을 눌러서 여러개를 한 번에 생성할 수 있다.
서브넷의 범위는 VPC 범위보다 작게 설정해주면 관리를 하기 쉬워진다.

private subnet 또한 마찬가지로 아래 예시와 같이 설정을 해줄 수 있다.

* **서브넷 이름: my-private-subnet-a**
* **IPv4 CIDR 블록: 10.0.0.24/28**

이렇게 설정을 해줄 수 있다.

vpc 범위가 24이기때문에 **10.0.0.0 ~ 10.0.0.255** 범위 내에서 블록을 설정해주면 된다. (각 옥텍은 255가 최대)

서브넷은 28로 범위 설정을 했기 때문에 10.0.0.0 ~ 10.0.0.15 범위 내에서 블록을 설정해준다.

<!-- 예시 테이블 -->

| 서브넷 이름 | IPv4 CIDR 블록 |
| --- | --- |
| my-public-subnet-a | 10.0.0.0/28 |
| my-public-subnet-c | 10.0.0.16/28 |
| my-private-subnet-a | 10.0.0.32/28 |
| my-private-subnet-c | 10.0.0.48/28 |




![서브넷 생성 결과](/assets/img/post/screenshot-2025-02-12-13-19-09.png)

## 라우팅 테이블

서브넷을 생성했다면 생성한 서브넷을 라우팅 테이블에 연결을 해줘야 한다.

라우팅 테이블은 서브넷과 연결이 되어있는 리소스다. 서브넷에서 네트워크를 이용할 때 이 라우팅 테이블을 이용해서 목적지를 찾게된다.

라우팅 테이블은 서브넷과 연결이 되어있지만 VPC를 생성할 때 기본적으로 라우팅 테이블이 생성되어 연결이 되어있다.

이 라우팅 테이블은 VPC 내부 서브넷을 만들 때 기본 라우팅 테이블로 사용이 된다.

### 생성하기

현재 나는 public subnet과 private subnet을 생성했기 때문에 public 라우팅 테이블과 private 라우팅 테이블을 생성해야 한다.

먼저 public 라우팅 테이블 생성을 하려고한다.

#### public routing table

라우팅 테이블에서 생성 버튼을 혹은 VPC를 생성할 때 기본으로 생성됐던 라우팅 테이블을 이용해서 public으로 만들어줄거다.

![public routing table 생성(1)](/assets//img/post/screenshot-2025-02-12-13-30-57.png)

이미지를 보게되면 **명시적 서브넷 연결**과 **명시적 연결이 없는 서브넷**이 보이는데

**명시적 연결이 없는 서브넷**은 라우팅 테이블에 연결이 되어있지 않은 서브넷을 말하고, **명시적 서브넷 연결**은 반대로 라우팅 테이블에 연결이 되어있는 서브넷을 의미한다.

명시적 서브넷 연결 박스에서 서브넷 연결 편집 버튼을 눌러서 서브넷을 연결해준다.

현재는 public 라우팅 테이블을 생성하고 있는 것이기 때문에 public 서브넷을 연결해줘야 한다.

private 라우팅 테이블에서 서브넷 연결을 할 때 마찬가지로 private으로 생성한 서브넷을 연결해주면 된다.

![routing table 생성 결과](/assets/img/post/screenshot-2025-02-12013-38-45.png)