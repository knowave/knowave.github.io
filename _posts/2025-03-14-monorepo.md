---
layout: post
title: "[TIL] Monorepo"
description: "Monorepo"
date: 2025-03-14 09:00:00 +0900
categories: [TIL]
tags: [TIL]
---

## Monorepo

최근에 회사에서 두 서비스가 서로 데이터를 통신을 해야 하는 일이 있었다. 보통 MSA를 생각하지만 개인적으로 MSA를 선호하는 편이 아니다.
1. MSA를 선호하지 않는 이유
   1. 서비스 간의 통신이 복잡해진다.
   2. 배포와 운영이 복잡해진다.
   3. 트랜잭션 관리가 어려워진다.
   4. 테스트가 어려워진다.
   5. 인프라 관리가 매우 힘들어진다. 

이러한 이유중 가장 선호하지 않는 이유가 2번과 5번이다. 현재 회사 인력 규모 상 <u>오직 인프라를 위해서 관리할 인력도 없고, 현재 나를 포함한 백엔드는
개발에 집중을 해야하는 상황</u>이다. 이런 상황에서 생각해낸게 **Monorepo**다.

Monorepo를 도입을 한다면 MSA와 비슷한 다음과 같은 이점이 있다고 생각했다.
1. 각 서비스 배포가 가능
2. 서비스별 통신이 더욱 더 간단함
3. 인프라 관리가 MSA보다 어렵지 않음.

이러한 이유로 채택을 해서 현재 멀티레포로 되어 있는 서비스를 모노레포로 마이그레이션 작업을 하려고 한다.

> **Multi-repo**는 각 프로젝트를 <u>별도의 저장소에서 관리</u>를 하는 것을 말한다.
> 프로젝트의 독립성이 있고, 단순한 접근이 가능하며 독립적인 배포가 가능하다는 장점이 있지만
> 프로젝트 간 의존성 관리의 복잡성, 코드 공유가 어려운 단점이 존재한다.

### Monorepo의 장점

Monorepo 방식은 **개발 및 운영을 단순화**하고, **협업을 원활하게 만드는 장점**이 있다고 생각한다.

#### 1) ✅ 원활한 개발 환경 유지
모든 프로젝트가 **하나의 저장소로 관리**되므로, 코드 스타일, 패키지 버전, CI/CD 파이프라인을 일관성있게 유지할 수 있다.

#### 2) ✅ 코드 재사용 극대화
여러 서비스에서 공통으로 사용하는 라이브러리를 한 저장소에서 직접 참조할 수 있어 **중복 코드 방지**와 **공유 라이브러리 관리**의 용이성이 높다.

#### 3) ✅ 원활한 협업
팀원들이 하나의 저장소에서 작업하므로 기능 개발 시 변경사항을 쉽게 추적이 가능하고, 여러 서비스 간의 동시 개발 및 배포의 장점이 있다.

#### 4) ✅ 인프라 및 devops 관리 부담 감소
저장소가 하나기 때문에 CI/CD 파이프라인이 단순해지고, 배포 및 환경 설정을 통합적으로 관리할 수 있어 운영 관련해서 관리 부담이 줄어든다.

### Monorepo의 단점

장점이 있다면 단점이 존재한다. Monorepo가 모든 상황에서 무조건 좋은 것은 아니다.

#### 1) 빌드 및 배포 속도 이슈

프로젝트가 커지면 커질 수록 빌드 시간이 길어질 수 있기 때문에 변경된 코드만 배포를 할 수 있는 **Selective Build 전략**이 필요하다.

#### 2) 버전 관리 충동 가능성

여러 개발자가 하나의 저장소에서 개발을 하다보니 git 충돌이 일어날 수 있어 git 브랜치 전략이 필요하다.

### 결론

위에서 Monorepo의 장점과 단점을 정리해봤다. 단점에 **배포 속도 이슈**, **버전 관리 충돌 가능성**의 이론적인 이슈가 있지만
현재 회사에서는 git flow 전략을 세우고 있어 버전 관리가 어렵지 않을 것 같고, 빌드 및 배포 속도 이슈는 Monorepo 도입 관련해서
걱정했던 부분이라 **Selective Build 전략**을 알고 들어갔다.

현재 회사에 주어진 리소스를 이용하면 Monorepo가 최선이라고 생각한다. 조금 더 서비스가 커지게 되면 멀티레포로 전환해서 MSA를 갈 수 있지만
SaaS 서비스가 주력인 서비스라 MSA는 필요가 없다고 생각하여 Monorepo가 적당할 것 같다.